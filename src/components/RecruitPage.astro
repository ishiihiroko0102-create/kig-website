---
import { getLangFromUrl, getLocalizedPath } from '../i18n/utils'
import { t } from '../i18n/translations'

const lang = getLangFromUrl(Astro.url)
const lp = (path: string) => getLocalizedPath(path, lang)

const jobs = lang === 'ja'
  ? [
      {
        title: '営業スタッフ',
        type: '正社員',
        salary: '月給 250,000円〜600,000円',
        salaryNote: '試用期間中：230,000円',
        location: '大阪府箕面市今宮3丁目2-3',
        desc: '自動車パーツの仕入れ営業、チューニングショップや整備工場への訪問営業が中心です。',
        duties: [
          '自動車パーツの仕入れ営業',
          'チューニングショップへの訪問営業',
          '整備工場への訪問営業',
          '既存顧客のフォロー',
        ],
      },
      {
        title: '倉庫内物流スタッフ',
        type: '正社員',
        salary: '月給 230,000円〜450,000円',
        salaryNote: '試用期間中：210,000円',
        location: '大阪府箕面市今宮3丁目2-3',
        desc: 'パーツの検品・洗浄・梱包・写真撮影・発送作業を担当していただきます。',
        duties: [
          'パーツの検品・洗浄',
          '梱包・発送作業',
          '商品写真撮影',
          '在庫管理',
        ],
      },
      {
        title: 'データ入力スタッフ',
        type: '正社員',
        salary: '月給 220,000円〜350,000円',
        salaryNote: '試用期間中：200,000円',
        location: '大阪府箕面市今宮3丁目2-3',
        desc: '商品情報をシステムに入力し、市場調査なども担当していただきます。',
        duties: [
          '商品情報のシステム入力',
          '市場調査・価格リサーチ',
          'データ整理・管理',
          '各種事務作業',
        ],
      },
    ]
  : [
      {
        title: 'Sales Staff',
        type: 'Full-time',
        salary: '¥250,000-¥600,000/month',
        salaryNote: 'During probation: ¥230,000',
        location: '3-2-3 Imamiya, Minoh, Osaka',
        desc: 'Primarily purchasing auto parts and visiting tuning shops and repair facilities.',
        duties: [
          'Auto parts purchasing',
          'Tuning shop visits',
          'Repair facility visits',
          'Customer follow-up',
        ],
      },
      {
        title: 'Warehouse Logistics Staff',
        type: 'Full-time',
        salary: '¥230,000-¥450,000/month',
        salaryNote: 'During probation: ¥210,000',
        location: '3-2-3 Imamiya, Minoh, Osaka',
        desc: 'Responsible for parts inspection, cleaning, packaging, photography, and shipping.',
        duties: [
          'Parts inspection & cleaning',
          'Packaging & shipping',
          'Product photography',
          'Inventory management',
        ],
      },
      {
        title: 'Data Entry Staff',
        type: 'Full-time',
        salary: '¥220,000-¥350,000/month',
        salaryNote: 'During probation: ¥200,000',
        location: '3-2-3 Imamiya, Minoh, Osaka',
        desc: 'Entering product information into the system and conducting market research.',
        duties: [
          'System data entry',
          'Market research & pricing',
          'Data organization',
          'General office work',
        ],
      },
    ]
---

<section class="page-hero">
  <div class="container">
    <p class="breadcrumb"><a href={lp('/')}>{t(lang, 'common.home')}</a> / {t(lang, 'recruitPage.breadcrumb')}</p>
    <h1 class="page-title">{t(lang, 'recruitPage.heroTitle')}</h1>
    <p class="page-sub">{t(lang, 'recruitPage.heroSub')}</p>
  </div>
</section>

<section class="section message-section">
  <div class="container">
    <div class="message-block fade-up">
      <p class="message-main" set:html={t(lang, 'recruitPage.message.main').replace(/\n/g, '<br />')} />
      <p class="message-body">{t(lang, 'recruitPage.message.body')}</p>
    </div>
    <div class="conditions-grid fade-up">
      <div class="condition-item">
        <div class="cond-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg>
        </div>
        <p class="cond-title">{t(lang, 'recruitPage.cond.1.title')}</p>
        <p>{t(lang, 'recruitPage.cond.1.desc')}</p>
      </div>
      <div class="condition-item">
        <div class="cond-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
        </div>
        <p class="cond-title">{t(lang, 'recruitPage.cond.2.title')}</p>
        <p>{t(lang, 'recruitPage.cond.2.desc')}</p>
      </div>
      <div class="condition-item">
        <div class="cond-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="8" r="6"/><path d="M15.477 12.89L17 22l-5-3-5 3 1.523-9.11"/></svg>
        </div>
        <p class="cond-title">{t(lang, 'recruitPage.cond.3.title')}</p>
        <p>{t(lang, 'recruitPage.cond.3.desc')}</p>
      </div>
      <div class="condition-item">
        <div class="cond-icon">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M1 4v6h6M23 20v-6h-6"/><path d="M20.49 9A9 9 0 005.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 013.51 15"/></svg>
        </div>
        <p class="cond-title">{t(lang, 'recruitPage.cond.4.title')}</p>
        <p>{t(lang, 'recruitPage.cond.4.desc')}</p>
      </div>
    </div>
  </div>
</section>

<section class="section jobs-section">
  <div class="container">
    <p class="section-label fade-up">OPEN POSITIONS</p>
    <h2 class="section-title fade-up">{t(lang, 'recruitPage.positions')}</h2>
    <div class="jobs-list">
      {jobs.map((job, i) => (
        <div class={`job-card fade-up ${i > 0 ? `fade-up-delay-${i}` : ''}`}>
          <div class="job-header">
            <div>
              <span class="job-type">{job.type}</span>
              <h3 class="job-title">{job.title}</h3>
            </div>
            <div class="job-salary">
              <p class="salary-num">{job.salary}</p>
              <p class="salary-note">{job.salaryNote}</p>
            </div>
          </div>
          <p class="job-desc">{job.desc}</p>
          <div class="job-details">
            <div>
              <p class="detail-label">{t(lang, 'recruitPage.job.duties')}</p>
              <ul>
                {job.duties.map(d => <li>{d}</li>)}
              </ul>
            </div>
            <div>
              <p class="detail-label">{t(lang, 'recruitPage.job.location')}</p>
              <p class="detail-val">{job.location}</p>
            </div>
          </div>
        </div>
      ))}
    </div>
  </div>
</section>

<section class="entry-section fade-up">
  <div class="container entry-inner">
    <div>
      <h2>{t(lang, 'recruitPage.entry.title')}</h2>
      <p>{t(lang, 'recruitPage.entry.desc')}</p>
    </div>
    <a href={lp('/contact')} class="btn btn-white">{t(lang, 'recruitPage.entry.cta')}</a>
  </div>
</section>

<style>
  .page-hero {
    background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
    padding: 60px 0;
  }
  .breadcrumb { font-size: 12px; color: rgba(255,255,255,0.5); margin-bottom: 16px; }
  .breadcrumb a { color: rgba(255,255,255,0.5); }
  .page-title { color: #fff; margin-bottom: 12px; }
  .page-sub { color: rgba(255,255,255,0.65); font-size: 16px; }

  .message-section { background: #f7f7f7; }
  .message-block {
    text-align: center;
    max-width: 720px;
    margin: 0 auto 56px;
  }
  .message-main {
    font-size: clamp(22px, 3vw, 32px);
    font-weight: 700;
    color: #0a0a0a;
    line-height: 1.5;
    letter-spacing: -0.01em;
    margin-bottom: 24px;
  }
  .message-body {
    font-size: 15px;
    color: #333333;
    line-height: 1.9;
  }
  .conditions-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 20px;
  }
  .condition-item {
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 12px;
    padding: 28px 20px;
    text-align: center;
  }
  .cond-icon { margin-bottom: 12px; display: flex; justify-content: center; align-items: center; color: #0a0a0a; }
  .cond-title { font-size: 15px; font-weight: 700; color: #0a0a0a; margin-bottom: 6px; }
  .condition-item p:last-child { font-size: 13px; color: #666666; }

  .jobs-section { background: #fff; }
  .jobs-list { margin-top: 48px; display: flex; flex-direction: column; gap: 24px; }
  .job-card {
    border: 1px solid #e0e0e0;
    border-radius: 16px;
    padding: 40px;
    transition: box-shadow 0.2s, border-color 0.2s;
  }
  .job-card:hover {
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    border-color: #0a0a0a;
  }
  .job-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 24px;
    gap: 24px;
  }
  .job-type {
    display: inline-block;
    background: #f5f5f5;
    color: #0a0a0a;
    font-size: 12px;
    font-weight: 600;
    padding: 3px 10px;
    border-radius: 4px;
    margin-bottom: 10px;
  }
  .job-title {
    font-size: 24px;
    font-weight: 700;
    color: #0a0a0a;
    letter-spacing: -0.01em;
  }
  .job-salary { text-align: right; }
  .salary-num { font-size: 18px; font-weight: 700; color: #0a0a0a; }
  .salary-note { font-size: 12px; color: #cccccc; margin-top: 4px; }
  .job-desc {
    font-size: 15px;
    color: #333333;
    line-height: 1.7;
    margin-bottom: 28px;
    padding-bottom: 28px;
    border-bottom: 1px solid #e0e0e0;
  }
  .job-details {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 32px;
  }
  .detail-label {
    font-size: 12px;
    font-weight: 600;
    color: #cccccc;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    margin-bottom: 12px;
  }
  .job-details ul {
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .job-details li {
    font-size: 14px;
    color: #333333;
    padding-left: 14px;
    position: relative;
  }
  .job-details li::before {
    content: '\2014';
    position: absolute;
    left: 0;
    color: #0a0a0a;
    font-weight: 700;
  }
  .detail-val { font-size: 14px; color: #333333; line-height: 1.6; }

  .entry-section {
    background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
    padding: 80px 0;
  }
  .entry-inner {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 40px;
  }
  .entry-section h2 {
    font-size: 28px;
    font-weight: 700;
    color: #fff;
    margin-bottom: 10px;
  }
  .entry-section p { font-size: 15px; color: rgba(255,255,255,0.65); }
  .btn-white { background: #fff; color: #0a0a0a; font-weight: 600; flex-shrink: 0; }
  .btn-white:hover { background: #f5f5f5; }

  @media (max-width: 768px) {
    .conditions-grid { grid-template-columns: repeat(2, 1fr); }
    .job-header { flex-direction: column; }
    .job-salary { text-align: left; }
    .job-details { grid-template-columns: 1fr; }
    .entry-inner { flex-direction: column; text-align: center; }
  }
</style>

<script>
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) { entry.target.classList.add('visible'); observer.unobserve(entry.target); }
    })
  }, { threshold: 0.1 })
  document.querySelectorAll('.fade-up').forEach(el => observer.observe(el))
</script>
